- name: test2
  hosts: localhost
  connection: local
  gather_facts: no
  tasks:
    - name: Check for Docker machine name
      set_fact:
        docker_machine_name: "{{ lookup('env','DOCKER_MACHINE_NAME') | default('NONE') }}" 

    - name: Get Docker Machine IP
      command: >
        docker-machine ip default        
      register: output
      when: docker_machine_name != 'NONE'

    - debug: var=output
